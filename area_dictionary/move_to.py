import os
import shutil


def move_files_by_name(source_folder, target_folder, filenames_to_move):
    """
    Перемещает файлы из source_folder в target_folder, если их имена совпадают с filenames_to_move

    :param source_folder: Папка, из которой нужно перемещать файлы
    :param target_folder: Папка, в которую нужно перемещать файлы
    :param filenames_to_move: Список имен файлов для перемещения
    """
    # Создаем целевую папку, если она не существует
    if not os.path.exists(target_folder):
        os.makedirs(target_folder)

    # Проходим по всем файлам в исходной папке
    for filename in os.listdir(source_folder):
        # Проверяем, что файл имеет расширение .xlsx
        if filename.lower().endswith('.xlsx'):
            # Получаем имя файла без расширения
            name_without_ext = os.path.splitext(filename)[0]

            # Проверяем, нужно ли перемещать этот файл
            if name_without_ext in filenames_to_move:
                source_path = os.path.join(source_folder, filename)
                target_path = os.path.join(target_folder, filename)

                # Перемещаем файл
                shutil.move(source_path, target_path)
                print(f"Файл '{filename}' перемещен в '{target_folder}'")


# Пример использования
if __name__ == "__main__":
    source_dir = r"\\192.168.252.25\аналитики\БАЗА\Выгрузки\Москва\Старая Москва"
    target_dir = r"\\192.168.252.25\аналитики\БАЗА\Выгрузки\Москва\Старая Москва\Архив"
    files_to_move = ['16 уровень', 'Ёлкино', 'Абрикосов', 'Академик (Троицк)', 'Академика Павлова', 'Акватория',
            'Алхимово', 'АМ-Студиос', 'Амбассадор', 'Аминьевское шоссе 5', 'Апартаменты в Кусково', 'Аура Белорусская',
            'Аэровилла', 'Аэролофтс', 'Балтийский', 'Балчуг Вьюпоинт', 'Бауман хаус',
            'Берёзовая аллея (Легендарный квартал)', 'Берег Яузы', 'Биг Пост', 'Большая Очаковская 2', 'Ботаник', 'Бук',
            'Букинист', 'Бунинские луга', 'В стремлении к свету', 'Вавилова 4', 'Вавилова 69', 'Вайт Хамовники',
            'Вангарден', 'Велтон Голд', 'Верди', 'Вери на Миклухо-Маклая', 'Вери', 'Веспер Тверская', 'Вилла Грейс',
            'Волоколамское 116с3', 'Волоколамское 24', 'Врубеля 4', 'Вэлтон СПА Резиденс', 'Голутвинский 10',
            'Город Дейли', 'Город на реке Тушино 2018', 'Город столиц', 'Грин парк', 'Гринада', 'Д1', 'Деко Резиденс',
            'Дербеневская 20', 'Диалог', 'Дискавери парк', 'Дискавери', 'Дмитровка 9', 'Дмитровский парк',
            'Долгоруковская', 'Дом Дуо', 'Дом на Барвихинской', 'Дом на Ивантеевской', 'Дом на Сретенке',
            'Дом на Таганке', 'Дом на Тишинке', 'Дом с Атлантами', 'Дом Франка', 'Домашний', 'Донское подворье',
            'Досфлота 10', 'Дыхание', 'Зе Файв', 'Зеленая вертикаль', 'Зеленоград сити', 'Измайлово',
            'Измайловский 22-1', 'Измайловский парк', 'Ильменский 17', 'Исток', 'Йес Технопарк', 'Картье Дор',
            'Квартал на Никулинской', 'Квартал Некрасовка (+ Абсолют)', 'Квартал Некрасовка (+Абсолют)',
            'Кварталы 21_19', 'Клубный дом в Газетном', 'Клубный дом на Покровке', 'Композиция 24', 'Композиция №24',
            'Концепт House', 'Королева 13', 'Красноказарменная 15', 'Кронштадтский 14', 'Крылатская 33',
            'Кузнецкий Мост 12', 'Кутузовский 12', 'Л-Клаб', 'Лайф Кутузовский_2020', 'Левел Донской', 'Ленинградка 58',
            'Лес', 'Летаж', 'Лефортово парк', 'Литтл', 'Лица', 'Логос', 'Лофт Аэропорт', 'Лофт Вольный',
            'Лофт на Вернадского, 41', 'Лофт на Марьиной Роще', 'Лофт на Радио', 'Лофт на Соколе',
            'Лофт на Шереметьевской', 'Лофт Нахимовский проспект', 'Лофт Рязанский', 'Лофт Центросоюзный 13с2',
            'Люблинский', 'Любовь и голуби', 'Люмин', 'Ля Рю', 'Магнум', 'Малевич', 'Манифест', 'Маяковский',
            'Мир Митино', 'Мира', 'Митте', 'Михайлова 31', 'Михайловский парк', 'Мой адрес в Алтуфьево',
            'Мой адрес в Ватутинках', 'Мой адрес в Зеленограде 901Б', 'Мой адрес в Зеленограде 936',
            'Мой адрес в Зеленограде', 'Мой адрес в Некрасовке-2', 'Мой адрес в Новогиреево', 'Мой адрес в Северном',
            'Мой адрес на Амурской', 'Мой адрес на Архитектора Власова 2', 'Мой адрес на Береговом',
            'Мой адрес на Варшавском 139', 'Мой адрес на Введенского 13В', 'Мой адрес на Дмитровском 89',
            'Мой адрес на Кастанаевской', 'Мой адрес на Клинской', 'Мой адрес на Коломенской', 'Мой адрес на Лавриенко',
            'Мой адрес на Люблинский 76 к.5', 'Мой адрес на Мельникова 2', 'Мой адрес на Молодцова 33',
            'Мой адрес на Профсоюзной 601', 'Мой адрес на Родниковой 5а', 'Мой адрес на Салтыковской',
            'Мой адрес на Сельскохозяйственной', 'Мой адрес на Ставропольской', 'Мой адрес на Харьковском 11',
            'Мой адрес на Шмитовском 39', 'Мой адрес на Якиманке', 'Монодом фэмили', 'Мостмен', 'Мосфильмовский',
            'Мэзон Руж', 'Мюр и Мерилиз', 'Мякинино Парк', 'Мята', 'На Большой Филевской', 'На Циолковского',
            'Нагорная 7', 'Настоящее', 'Нау', 'Нахимов', 'Невский 18', 'Невский', 'Нобл', 'Новоданиловская 8',
            'Новое Очаково', 'Новые академики', 'Нормандия', 'Нью Форм Жигулевская', 'Обыденский 1', 'Огни', 'Око',
            'Октябрь', 'Оливковый дом', 'Олл ин Салют', 'Орехово. Дом у парка', 'Оро', 'Открытый парк', 'Павлова 40',
            'Парк плаза', 'Парк Плейс Сокольники', 'Парковая апартаменты', 'Патрикс', 'Первый Ленинградский',
            'Пересветов 9', 'Переяславская 27с1', 'Поклонная №7', 'Поклонная №7_приостановлен', 'Полярная 25',
            'Пресненский вал 21', 'Пречистенка 8', 'Призма', 'Просторная 7', 'Профит', 'Расцветай в Люблино',
            'РГ. Воронцовский парк', 'Ред Сайд', 'Ред стар лофт-2', 'Резиденция 1864 (Царев сад)',
            'Резиденция архитекторов', 'Резиденция композиторов', 'Резиденция Тверская', 'Резиденция холл Шаболовский',
            'Рестарт', 'Ривер Резиденс (БОР)', 'Римского Корсакова 11', 'Римского Корсакова', 'Рихард',
            'Родина Переделкино', 'Роза Росса', 'Рощинская 10', 'Руновский 14', 'Саввин Ривер Резиденс',
            'Светлый Мир. Станция Л', 'Светлый Мир. Станция Л_приостановлен', 'Сердце столицы', 'Серебряный фонтан',
            'Сигнальный 16', 'Силвер', 'Синатра', 'Сказочный лес', 'Скай форт', 'Соседи 21_19', 'Софийский',
            'Сохо Нохо', 'Спайрс', 'Станция', 'Стелла ди Моска Хотел', 'Столичные поляны', 'Сторис', 'Суббота',
            'Суворовская 19', 'Счастье в Кузьминках', 'Счастье в Царицыно', 'Счастье в Чертаново',
            'Счастье на Волгоградке', 'Счастье на Ломоносовском', 'Счастье на Масловке', 'Счастье на Пресне',
            'Счастье на Семеновской', 'Талисман на Водном', 'Талисман на Дмитровском', 'Талисман', 'Татлин',
            'Театральный дом', 'Титул на Якиманке', 'Топ 5', 'Турист', 'Ты и я', 'Фантастик Хаус', 'Федерация', 'Ферст',
            'Фили сити', 'Форест', 'Фридом', 'Хайд Аут', 'Хорошевский', 'Цвет 32', 'Шереметьевский', 'Шерстон',
            'Эдисон Хаус', 'Эйр Спейс', 'Электролитный, 5Б', 'Эталон Сити', 'Ютаново', 'Я51', 'Ясеневая 14', 'Ясный']

    move_files_by_name(source_dir, target_dir, files_to_move)